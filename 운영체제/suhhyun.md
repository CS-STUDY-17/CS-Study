# 운영체제
## 운영체제와 컴퓨터
### 운영체제의 역할
1. CPU 스케줄링 및 프로세스 관리: CPU 소유권을 어떤 프로세스에 할당할지, 프로세스의 생성과 삭제, 자원 할당 및 반환 관리  
2. 메모리 관리: 한정된 메모리를 어떤 프로세스에 얼마나 할당할지 관리
3. 디스크 관리: 디스크 파일 보관 관리
4. I/O 디바이스 관리: 키보드, 마우스와 같은 I/O 디바이스와 컴퓨터 간에 데이터 주고받는 것을 관리

| 운영체제의 구조 |
|-----|
| 유저 프로그램 |
| GUI |
| 커널  |
| 드라이버 |
| 하드웨어 |

- GUI: 사용자가 장치와 상호작용할 수 있도록 하는 사용자 인터페이스의 한 형태
- 드라이버: 하드웨어 제어를 위한 소프트웨어
- CUI: 그래픽이 아닌 명령어로 처리하는 인터페이스  

#### 시스템콜
운영체제가 커널에 접근하기 위한 인터페이스
유저 프로그램이 운영체제 사용 -> 운영체제는 시스템콜을 통해 커널 함수 호출

ex. 파일 읽기 요청
유저 모드로 요청 -> 시스템콜 -> 커널 모드로 변경 -> 파일 읽기 수행
- 컴퓨터 자원에 직접적인 접근 차단
- 프로그램을 다른 프로그램으로 부터 보호

모드비트(modebit)
- 0: 커널 모드
- 1: 유저 모드

### 컴퓨터의 요소
- CPU
  - ALU + 제어장치 + 레지스터로 구성
    - ALU: 덧셈, 뺄셈, 논리곱 등 산술과 논리연산을 계산하는 디지털회로
    - 제어장치: 통신 제어, 명령 읽고 해석, 순서 결정
    - 레지스터: CPU 안의 매우 빠른 임시기억장치
  - 인터럽트에 의해 단순히 메모리에 저장된 명령을 해석하고 실행
    - 인터럽트: 신호가 들어왔을 때 CPU를 잠시 정지시키는 것
      - 하드웨어 인터럽트: I/O 디바이스에 의한 인터럽트
      - 소프트웨어 인터럽트(trap): 프로세스 오류로 인한 인터럽트
- RAM(메모리) & 메모리 컨트롤러: 기억을 담당, 메모리가 클수록 많은 일을 동시에 할 수 있음
- DMA 컨트롤러: I/O 디바이스가 메모리에 직접 접근 가능하게 함, CPU 보조일꾼
- 타이머: 특정 프로세스에 시간 제한을 둠
- 디바이스 컨트롤러 & 로컬 버퍼 & 디바이스

### 메모리
#### 메모리 계층
| 메모리 계층          |
|-----------------|
| 레지스터            |
| 캐시              |
| 메모리(RAM)/주기억장치  |
| 저장장치/보조기억장치     |
- 레지스터: CPU 내부의 작은 메모리  
- 보조기억장치: 비휘발성, HDD, SSD 등을 나타냄  

계층 구조를 두는 이유: 경제성 & 캐시  
캐시: 데이터를 미리 복사해 두는 임시 저장소 & 속도 차이에 따른 병목 현상을 줄이기 위한 메모리
* 캐싱 계층: 속도 차이를 해결하기 위해 계층과 계층 사이에 두는 계층

지역성
- 시간 지역성: 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성: 최근 접근한 데이터를 이루고 있는공간, 또는 그 가까운 공간에 접근하려는 특성

캐시매핑
- 직접 매핑
- 연관 매핑
- 집한 연관 매핑

웹 브라우저의 캐시
- 쿠키: 4KB, 만료기한 O
- 로컬 스토리지: 10MB, 만료기한 X
- 세션 스토리지: 5MB, 만료기한 X

#### 메모리 관리
- 가상 메모리: 가상 주소와 실제 주소 매핑, 프로세스의 주소 정보 담은 페이지 테이블로 관리
  - TLB: 주소 변환을 위한 캐시
- 스와핑:  페이지 폴트가 일어나면 메모리와 하드디스크의 영역을 교환
- 페이지 폴트: 가상메모리에는 존재하지만 메모리에는 존재하지 않는 데이터에 접근하려고 할 때
- 스레싱: 메모리의 페이지 폴트율이 높은 것을 의미,
  메모리에 너무 많은 프로세스가 동시에 올라가면 스와핑 발생률 증가  
-> 페이지 폴트 증가 = CPU 이용률 감소   
-> CPU가 한가하다고 착각하고 더 많은 프로세스를 메모리에 올림

- 메모리 할당
  - 연속 할당
    - 고정 분할 방식: 내부 단편화
    - 가변 분할 방식: 외부 단편화
      - 최초적합
      - 최적적합
      - 최악적합
  - 불연속 할당
    - 페이징 기법: 메모리를 동일한 크기의 페이지(보통 4KB)로 나누고 메모리의 서로 다른 위치에 프로그램 할당
    - 세그멘테이션: 의미 단위인 세그먼트로 나눔
    - 페이지드 세그멘테이션: 프로그램을 의미 단위인 세그먼트로 나눠 공유나 보안에서 이득, 동일한 크기의 페이지 단위로 나눔

페이지 교체 알고리즘
- 오프라인 알고리즘
- FIFO
- LRU: 참조가 가장 오래된 페이지 바꿈, 각 페이지마다 계수기, 스택 필요
- NUR(= clock alg)
- LFU: 가장 참조 횟수가 적은 페이지 교체